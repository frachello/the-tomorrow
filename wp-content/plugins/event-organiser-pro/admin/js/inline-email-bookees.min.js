/*! event-organiser-pro 1.8.1 2014-08-11 22:40 */
var eventorganiser=eventorganiser||{};eventorganiser.versionCompare=function(a,b){if(typeof a+typeof b!="stringstring")return!1;for(var c=a.split("."),d=b.split("."),e=0,f=Math.max(c.length,d.length);f>e;e++){if(c[e]&&!d[e]&&parseInt(c[e],10)>0||parseInt(c[e],10)>parseInt(d[e],10))return 1;if(d[e]&&!c[e]&&parseInt(d[e],10)>0||parseInt(c[e],10)<parseInt(d[e],10))return-1}return 0},function(a){var b={init:function(){this.hide();var b=this,c=this.attr("id"),d=a.map(this.children("optgroup"),function(b){var c=a.map(a(b).children("option"),function(b){return{value:a(b).val(),label:a(b).text()}});return{values:c,label:a(b).attr("label")}}),e=a('<ul id="'+c+'-es" class="eo-multiselect-checkboxes ui-helper-reset"></ul>').insertAfter(this);a.each(d,function(b,c){var d=a("<ul></ul>");a("<li class='eo-multiselect-optgroup-label'><a class='ui-widget-header ui-corner-all eo-multiselect-header ui-helper-clearfix' href='#'>"+c.label+"</a></li>").children("a").toggle(function(){a(this).parent().find("li input").attr("checked",!0).trigger("change")},function(){a(this).parent().find("li input").attr("checked",!1).trigger("change")}).parent().appendTo(e).append(d),a.each(c.values,function(a,b){d.append('<li class="eo-multiselect-option"><label class="ui-corner-all"><input type="checkbox" value="'+b.value+'" title="'+b.label+'"><span> '+b.label+" </span></label></li>")})}),jQuery.expr[":"].containsInsensitive=function(a,b,c){return(a.textContent||a.innerText||"").toUpperCase().indexOf(c[3].toUpperCase())>=0};var f=a('<input type="text" class="eo-multiselect-filter" placeholder="Filter">');return e.wrap('<div class="eo-multiselect ui-widget ui-widget-content ui-corner-all" />').before(f),f.keyup(function(b){b.preventDefault();var c=a(this).val();c?(e.find("li ul li label span:not(:containsInsensitive("+c+"))").parents("li.eo-multiselect-option").hide(),e.find("li ul li label span:containsInsensitive("+c+")").parents("li.eo-multiselect-option").show()):e.find("li.eo-multiselect-option").show()}),e.find("li ul li").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).find("input:checkbox").change(function(){var c=a(this).val();b.find('option[value="'+c+'"]').attr("selected",this.checked)}),this}};a.fn.easySelect=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.tooltip"):b.init.apply(this,arguments)}}(jQuery),function(a){inlineEditBooking={init:function(){var b=this,c=a("#bulk-email"),d=a("#bulk-download");b.what="#booking-",c.keyup(function(a){return 27==a.which?inlineEditBooking.revert():void 0}),d.keyup(function(a){return 27==a.which?inlineEditBooking.revert():void 0}),a("#eo-bookings-table").on("click",".delete .submitdelete",function(a){var b=confirm("Are you sure you wish to delete this booking?\n\n This action cannot be undone.");b!==!0&&a.preventDefault()}),a("a.cancel",c).click(function(){return inlineEditBooking.revert()}),a("a.cancel",d).click(function(){return inlineEditBooking.revert()}),a("#eo-meta-labels").easySelect(),a("#download-bookings-trigger").click(function(c){c.preventDefault(),a("form#posts-filter tr.inline-editor").length>0?b.revert():b.showOptions()}),a("#doaction, #doaction2").click(function(c){var d=a(this).attr("id").substr(2);if("email"==a('select[name="'+d+'"]').val())c.preventDefault(),b.setEmail();else if("delete"==a('select[name="'+d+'"]').val()){var e=confirm("Are you sure you wish to delete these bookings?\n\n This action cannot be undone.");e!==!0&&c.preventDefault(),b.revert()}else a("form#posts-filter tr.inline-editor").length>0&&b.revert()}),a("#post-query-submit").mousedown(function(){b.revert(),a('select[name^="action"]').val("-1")})},toggle:function(b){var c=this;"none"==a(c.what+c.getId(b)).css("display")?c.revert():c.edit(b)},showOptions:function(){var b=!0;return this.revert(),a("#bulk-download td").attr("colspan",a(".widefat:first thead th:visible").length),a("table.widefat tbody").prepend(a("#bulk-download")),a("#bulk-download").addClass("inline-editor").show(),(b=!1)?this.revert():void a("html, body").animate({scrollTop:0},"fast")},setEmail:function(){var b="",c=!0;this.revert(),a("#bulk-email td").attr("colspan",a(".widefat:first thead th:visible").length),a("table.widefat tbody").prepend(a("#bulk-email")),a("#bulk-email").addClass("inline-editor").show();var d=[];return a('tbody th.check-column input[type="checkbox"]').each(function(){if(a(this).prop("checked")){c=!1;var e,f=a(this).val();e=a("#inline_"+f+" .username").text()||!1,e&&(b+='<div id="ttleemail'+f+'"><a id="_'+f+'" class="ntdelbutton" title="click to remove">X</a>'+e+"</div>",d.push(e))}}),c?this.revert():(a("#bulk-email-titles").html(b),a("#bulk-email-titles a").click(function(){var b=a(this).attr("id").substr(1);a('table.widefat input[value="'+b+'"]').prop("checked",!1),a("#ttleemail"+b).remove()}),void a("html, body").animate({scrollTop:0},"fast"))},revert:function(){var b=a("table.widefat tr.inline-editor").attr("id");return b&&(a("table.widefat .inline-edit-save .waiting").hide(),"bulk-edit"==b?(a("table.widefat #bulk-edit").removeClass("inline-editor").hide(),a("#bulk-titles").html(""),a("#inlineedit").append(a("#bulk-edit"))):"bulk-email"==b?(a("table.widefat #bulk-email").removeClass("inline-editor").hide(),a("#bulk-email-titles").html(""),a("#inlineedit").append(a("#bulk-email"))):"bulk-download"==b?(a("table.widefat .inline-edit-save .waiting").hide(),a("table.widefat #bulk-download").removeClass("inline-editor").hide(),a("#bulk-download-edit").append(a("#bulk-email"))):(a("#"+b).remove(),b=b.substr(b.lastIndexOf("-")+1),a(this.what+b).show())),!1},getId:function(b){var c=a(b).closest("tr").attr("id"),d=c.split("-");return d[d.length-1]}},a(document).ready(function(){if(inlineEditBooking.init(),a("#booking-search-input").length>0){a("#booking-search-input").autocomplete({delay:0,source:function(b,c){a.getJSON(ajaxurl+"?callback=?&action=eo-search-bookings",b,function(b){c(a.map(b,function(a){return a.label=a.event,a.value="#"+a.booking_id,a}))})},select:function(a,b){window.location.href=b.item.edit_link}}).addClass("ui-widget-content ui-corner-left");var b=a.ui?a.ui.version||0:-1,c=eventorganiser.versionCompare(b,"1.9")>=0?"ui-autocomplete":"autocomplete",d=eventorganiser.versionCompare(b,"1.9")>=0?"ui-autocomplete-item":"item.autocomplete";a("#booking-search-input").data(c)._renderItem=function(b,c){if(0===c.booking_id)return a("<li></li>").data(d,c).append(c.label).appendTo(b);var e=(this.term+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\\<\>\|\:])/g,"\\$1");"#"==e.charAt(0)&&(e=e.substr(1));var f=new RegExp("("+e+")","gi");return c.booking_id=c.booking_id.replace(f,"<span style='font-weight:bold;'>$1</span>"),c.bookee=c.bookee.replace(f,"<span style='font-weight:bold;'>$1</span>"),c.event=c.event.replace(f,"<span style='font-weight:bold;'>$1</span>"),c.bookee_email=c.bookee_email.replace(f,"<span style='font-weight:bold;'>$1</span>"),a("<li></li>").data("item.autocomplete",c).append("<a style='overflow:auto'><span style='float:left; margin-right:10px;'><span style='color:#333;line-height:50px;font-size:14px;'>#"+c.booking_id+"</span></span><span style='float:left'>"+c.event+"</br><span style='font-size: 0.8em'><em>"+c.bookee+" <br/>"+c.bookee_email+"</em></span></span><span style='clear:both'></span></a>").appendTo(b)}}})}(jQuery);